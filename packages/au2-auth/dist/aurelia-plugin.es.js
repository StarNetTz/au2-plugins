import{IHttpClient,json,HttpClient}from"@aurelia/fetch-client";import{DI,IEventAggregator,Registration}from"@aurelia/kernel";import{lifecycleHooks}from"@aurelia/runtime-html";import{IRouter}from"@aurelia/router-lite";import{valueConverter}from"@aurelia/runtime";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function __decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}function __param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function __metadata(metadataKey,metadataValue){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(metadataKey,metadataValue)}const IAuthConfigOptions=DI.createInterface("IAuthConfigOptions");let Storage=class{config;storage;constructor(config){this.config=config,this.storage=this._getStorage(this.config.storage)}get(key){return this.storage.getItem(key)}set(key,value){return this.storage.setItem(key,value)}remove(key){return this.storage.removeItem(key)}_getStorage(type){if("localStorage"===type){if("localStorage"in window&&null!==window.localStorage)return localStorage;throw new Error("Local Storage is disabled or unavailable.")}if("sessionStorage"===type){if("sessionStorage"in window&&null!==window.sessionStorage)return sessionStorage;throw new Error("Session Storage is disabled or unavailable.")}throw new Error("Invalid storage type specified: "+type)}};Storage=__decorate([__param(0,IAuthConfigOptions),__metadata("design:paramtypes",[Object])],Storage);let slice=[].slice;function baseExtend(dst,objs,deep){let h=dst.$$hashKey;for(let i=0,ii=objs.length;i<ii;++i){let obj=objs[i];if(!isObject(obj)&&!isFunction(obj))continue;let keys=Object.keys(obj);for(let j=0,jj=keys.length;j<jj;j++){let key=keys[j],src=obj[key];deep&&isObject(src)?(isObject(dst[key])||(dst[key]=Array.isArray(src)?[]:{}),baseExtend(dst[key],[src],!0)):dst[key]=src}}return function(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}(dst,h),dst}function status(response){if(response.status>=200&&response.status<400)return response.json().catch((error=>null));throw response}function parseQueryString(keyValue){let key,value,obj={};return forEach((keyValue||"").split("&"),(function(kv){kv&&(value=kv.split("="),key=decodeURIComponent(value[0]),obj[key]=!function(value){return void 0!==value}(value[1])||decodeURIComponent(value[1]))})),obj}function isString(value){return"string"==typeof value}function isObject(value){return null!==value&&"object"==typeof value}function isFunction(value){return"function"==typeof value}function joinUrl(baseUrl,url){if(/^(?:[a-z]+:)?\/\//i.test(url))return url;let joined=[baseUrl,url].join("/");return joined.replace(/[\/]+/g,"/").replace(/\/\?/g,"?").replace(/\/\#/g,"#").replace(/\:\//g,"://")}function extend(dst){return baseExtend(dst,slice.call(arguments,1),!1)}function forEach(obj,iterator,context){let key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"===key||"length"===key||"name"===key||obj.hasOwnProperty&&!obj.hasOwnProperty(key)||iterator.call(context,obj[key],key,obj);else if(Array.isArray(obj)||function(obj){if(null===obj||function(obj){return obj&&obj.window===obj}(obj))return!1}(obj)){let isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;key<length;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else if(null===(value=obj)||"object"!=typeof value||Object.getPrototypeOf(value))if("function"==typeof obj.hasOwnProperty)for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);else for(key in obj)hasOwnProperty.call(obj,key)&&iterator.call(context,obj[key],key,obj);else for(key in obj)iterator.call(context,obj[key],key,obj);var value;return obj}let Authentication=class{storage;config;tokenName;idTokenName;initialUrl;constructor(storage,config){this.storage=storage,this.config=config,this.storage=storage,this.tokenName=this.config.tokenPrefix?this.config.tokenPrefix+"_"+this.config.tokenName:this.config.tokenName,this.idTokenName=this.config.tokenPrefix?this.config.tokenPrefix+"_"+this.config.idTokenName:this.config.idTokenName}getLoginRoute(){return this.config.loginRoute}getLoginRedirect(){return this.initialUrl||this.config.loginRedirect}getLoginUrl(){return this.config.baseUrl?joinUrl(this.config.baseUrl,this.config.loginUrl):this.config.loginUrl}getSignupUrl(){return this.config.baseUrl?joinUrl(this.config.baseUrl,this.config.signupUrl):this.config.signupUrl}getProfileUrl(){return this.config.baseUrl?joinUrl(this.config.baseUrl,this.config.profileUrl):this.config.profileUrl}getToken(){return this.storage.get(this.tokenName)}getPayload(){let token=this.storage.get(this.tokenName);return this.decomposeToken(token)}decomposeToken(token){if(token&&3===token.split(".").length){let base64=token.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");try{return JSON.parse(decodeURIComponent(escape(window.atob(base64))))}catch(error){return null}}}setInitialUrl(url){this.initialUrl=url}setToken(response,redirect){let tokenToStore,accessToken=response&&response[this.config.responseTokenProp];accessToken&&(isObject(accessToken)&&isObject(accessToken.data)?response=accessToken:isString(accessToken)&&(tokenToStore=accessToken)),!tokenToStore&&response&&(tokenToStore=this.config.tokenRoot&&response[this.config.tokenRoot]?response[this.config.tokenRoot][this.config.tokenName]:response[this.config.tokenName]),tokenToStore&&this.storage.set(this.tokenName,tokenToStore);let idToken=response&&response[this.config.responseIdTokenProp];idToken&&this.storage.set(this.idTokenName,idToken),this.config.loginRedirect&&!redirect?window.location.href=this.getLoginRedirect():redirect&&isString(redirect)&&(window.location.href=window.encodeURI(redirect))}removeToken(){this.storage.remove(this.tokenName)}isAuthenticated(){let exp,token=this.storage.get(this.tokenName);if(!token)return!1;if(3!==token.split(".").length)return!0;try{let base64=token.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");exp=JSON.parse(window.atob(base64)).exp}catch(error){return!1}return!exp||Math.round((new Date).getTime()/1e3)<=exp}logout(redirect){return new Promise((resolve=>{this.storage.remove(this.tokenName),this.config.logoutRedirect&&!redirect?window.location.href=this.config.logoutRedirect:isString(redirect)&&(window.location.href=redirect),resolve()}))}get tokenInterceptor(){let config=this.config,storage=this.storage,auth=this;return{request(request){if(auth.isAuthenticated()&&config.httpInterceptor){let tokenName=config.tokenPrefix?`${config.tokenPrefix}_${config.tokenName}`:config.tokenName,token=storage.get(tokenName);config.authHeader&&config.authToken&&(token=`${config.authToken} ${token}`),request.headers.set(config.authHeader,token)}return request}}}};Authentication=__decorate([__param(1,IAuthConfigOptions),__metadata("design:paramtypes",[Storage,Object])],Authentication);let FetchConfig=class{httpClient;auth;constructor(httpClient,auth){this.httpClient=httpClient,this.auth=auth}configure(){this.httpClient.configure((httpConfig=>(httpConfig.withInterceptor(this.auth.tokenInterceptor),httpConfig)))}};FetchConfig=__decorate([__param(0,IHttpClient),__metadata("design:paramtypes",[Object,Authentication])],FetchConfig);const defaultAuthConfigOptions={httpInterceptor:!0,loginOnSignup:!0,baseUrl:"/",loginRedirect:"#/",logoutRedirect:"#/",signupRedirect:"#/login",loginUrl:"/auth/login",signupUrl:"/auth/signup",profileUrl:"/auth/me",loginRoute:"/login",signupRoute:"/signup",tokenRoot:void 0,tokenName:"token",idTokenName:"id_token",tokenPrefix:"aurelia",responseTokenProp:"access_token",responseIdTokenProp:"id_token",unlinkUrl:"/auth/unlink/",unlinkMethod:"get",authHeader:"Authorization",authToken:"Bearer",withCredentials:!0,platform:"browser",storage:"localStorage",providers:{identSrv:{name:"identSrv",url:"/auth/identSrv",redirectUri:window.location.origin||window.location.protocol+"//"+window.location.host,scope:["profile","openid"],responseType:"code",scopePrefix:"",scopeDelimiter:" ",requiredUrlParams:["scope","nonce"],optionalUrlParams:["display","state"],state:function(){const rand=Math.random().toString(36).substr(2);return encodeURIComponent(rand)},display:"popup",type:"2.0",clientId:"jsClient",nonce:function(){const val=((Date.now()+Math.random())*Math.random()).toString().replace(".","");return encodeURIComponent(val)},popupOptions:{width:452,height:633}},google:{name:"google",url:"/auth/google",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",redirectUri:window.location.origin||window.location.protocol+"//"+window.location.host,scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",requiredUrlParams:["scope"],optionalUrlParams:["display","state"],display:"popup",type:"2.0",state:function(){const rand=Math.random().toString(36).substr(2);return encodeURIComponent(rand)},popupOptions:{width:452,height:633}},facebook:{name:"facebook",url:"/auth/facebook",authorizationEndpoint:"https://www.facebook.com/v2.3/dialog/oauth",redirectUri:window.location.origin+"/"||window.location.protocol+"//"+window.location.host+"/",scope:["email"],scopeDelimiter:",",nonce:function(){return Math.random()},requiredUrlParams:["nonce","display","scope"],display:"popup",type:"2.0",popupOptions:{width:580,height:400}},linkedin:{name:"linkedin",url:"/auth/linkedin",authorizationEndpoint:"https://www.linkedin.com/uas/oauth2/authorization",redirectUri:window.location.origin||window.location.protocol+"//"+window.location.host,requiredUrlParams:["state"],scope:["r_emailaddress"],scopeDelimiter:" ",state:"STATE",type:"2.0",popupOptions:{width:527,height:582}},github:{name:"github",url:"/auth/github",authorizationEndpoint:"https://github.com/login/oauth/authorize",redirectUri:window.location.origin||window.location.protocol+"//"+window.location.host,optionalUrlParams:["scope"],scope:["user:email"],scopeDelimiter:" ",type:"2.0",popupOptions:{width:1020,height:618}},yahoo:{name:"yahoo",url:"/auth/yahoo",authorizationEndpoint:"https://api.login.yahoo.com/oauth2/request_auth",redirectUri:window.location.origin||window.location.protocol+"//"+window.location.host,scope:[],scopeDelimiter:",",type:"2.0",popupOptions:{width:559,height:519}},twitter:{name:"twitter",url:"/auth/twitter",authorizationEndpoint:"https://api.twitter.com/oauth/authenticate",type:"1.0",popupOptions:{width:495,height:645}},live:{name:"live",url:"/auth/live",authorizationEndpoint:"https://login.live.com/oauth20_authorize.srf",redirectUri:window.location.origin||window.location.protocol+"//"+window.location.host,scope:["wl.emails"],scopeDelimiter:" ",requiredUrlParams:["display","scope"],display:"popup",type:"2.0",popupOptions:{width:500,height:560}},instagram:{name:"instagram",url:"/auth/instagram",authorizationEndpoint:"https://api.instagram.com/oauth/authorize",redirectUri:window.location.origin||window.location.protocol+"//"+window.location.host,requiredUrlParams:["scope"],scope:["basic"],scopeDelimiter:"+",display:"popup",type:"2.0",popupOptions:{width:550,height:369}}}};let Popup=class{config;popupWindow=null;polling;url;constructor(config){this.config=config,this.popupWindow=null,this.polling=null,this.url=""}open(url,windowName,options,redirectUri){this.url=url;let optionsString=this.stringifyOptions(this.prepareOptions(options||{}));return this.popupWindow=window.open(url,windowName,optionsString),this.popupWindow&&this.popupWindow.focus&&this.popupWindow.focus(),this}eventListener(redirectUri){return new Promise(((resolve,reject)=>{this.popupWindow.addEventListener("loadstart",(event=>{if(0!==event.url.indexOf(redirectUri))return;let parser=document.createElement("a");if(parser.href=event.url,parser.search||parser.hash){let queryParams=parser.search.substring(1).replace(/\/$/,""),hash=parseQueryString(parser.hash.substring(1).replace(/\/$/,"")),qs=parseQueryString(queryParams);extend(qs,hash),qs.error?reject({error:qs.error}):resolve(qs),this.popupWindow.close()}})),this.popupWindow.addEventListener("exit",(()=>{reject({data:"Provider Popup was closed"})})),this.popupWindow.addEventListener("loaderror",(()=>{throw new Error("Authorization Failed")}))}))}pollPopup(){return new Promise(((resolve,reject)=>{this.polling=setInterval((()=>{try{let documentOrigin=document.location.host;if(this.popupWindow.location.host===documentOrigin&&(this.popupWindow.location.search||this.popupWindow.location.hash)){let queryParams=this.popupWindow.location.search.substring(1).replace(/\/$/,""),hash=parseQueryString(this.popupWindow.location.hash.substring(1).replace(/[\/$]/,"")),qs=parseQueryString(queryParams);extend(qs,hash),qs.error?reject({error:qs.error}):resolve(qs),this.popupWindow.close(),clearInterval(this.polling)}}catch(error){}this.popupWindow?this.popupWindow.closed&&(clearInterval(this.polling),reject({data:"Problem poll popup"})):(clearInterval(this.polling),reject({data:"Provider Popup Blocked"}))}),35)}))}prepareOptions(options){let width=options.width||500,height=options.height||500;return extend({width:width,height:height,left:window.screenX+(window.outerWidth-width)/2,top:window.screenY+(window.outerHeight-height)/2.5},options)}stringifyOptions(options){let parts=[];return forEach(options,(function(value,key){parts.push(key+"="+value)})),parts.join(",")}};Popup=__decorate([__param(0,IAuthConfigOptions),__metadata("design:paramtypes",[Object])],Popup);let OAuth1=class{storage;popup;http;config;defaults;popupInstance;constructor(storage,popup,http,config){this.storage=storage,this.popup=popup,this.http=http,this.config=config,this.defaults={url:null,name:null,popupOptions:null,redirectUri:null,authorizationEndpoint:null}}open(options,userData){let current=extend({},this.defaults,options),serverUrl=this.config.baseUrl?joinUrl(this.config.baseUrl,current.url):current.url;return"mobile"!==this.config.platform&&(this.popupInstance=this.popup.open("",current.name,current.popupOptions,current.redirectUri)),this.http.fetch(serverUrl,{method:"post"}).then(status).then((response=>("mobile"===this.config.platform?this.popupInstance=this.popup.open([current.authorizationEndpoint,this.buildQueryString(response)].join("?"),current.name,current.popupOptions,current.redirectUri):this.popupInstance.popupWindow.location=[current.authorizationEndpoint,this.buildQueryString(response)].join("?"),("mobile"===this.config.platform?this.popup.eventListener(current.redirectUri):this.popup.pollPopup()).then((result=>this.exchangeForToken(result,userData,current))))))}exchangeForToken(oauthData,userData,current){let data=extend({},userData,oauthData),exchangeForTokenUrl=this.config.baseUrl?joinUrl(this.config.baseUrl,current.url):current.url,credentials=this.config.withCredentials?"include":"same-origin";return this.http.fetch(exchangeForTokenUrl,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:json(data),credentials:credentials}).then(status)}buildQueryString(obj){let str=[];return forEach(obj,((value,key)=>str.push(encodeURIComponent(key)+"="+encodeURIComponent(value)))),str.join("&")}};OAuth1=__decorate([__param(2,IHttpClient),__param(3,IAuthConfigOptions),__metadata("design:paramtypes",[Storage,Popup,Object,Object])],OAuth1);let OAuth2=class{storage;popup;auth;http;config;defaults;constructor(storage,popup,auth,http,config){this.storage=storage,this.popup=popup,this.auth=auth,this.http=http,this.config=config,this.defaults={url:null,name:null,state:null,scope:null,scopeDelimiter:null,redirectUri:null,popupOptions:null,authorizationEndpoint:null,responseParams:null,requiredUrlParams:null,optionalUrlParams:null,defaultUrlParams:["response_type","client_id","redirect_uri"],responseType:"code"}}open(options,userData){let current=extend({},this.defaults,options),stateName=current.name+"_state";isFunction(current.state)?this.storage.set(stateName,current.state()):isString(current.state)&&this.storage.set(stateName,current.state);let nonceName=current.name+"_nonce";isFunction(current.nonce)?this.storage.set(nonceName,current.nonce()):isString(current.nonce)&&this.storage.set(nonceName,current.nonce);let openPopup,url=current.authorizationEndpoint+"?"+this.buildQueryString(current);return openPopup="mobile"===this.config.platform?this.popup.open(url,current.name,current.popupOptions,current.redirectUri).eventListener(current.redirectUri):this.popup.open(url,current.name,current.popupOptions,current.redirectUri).pollPopup(),openPopup.then((oauthData=>oauthData.state&&oauthData.state!==this.storage.get(stateName)?Promise.reject("OAuth 2.0 state parameter mismatch."):-1!==current.responseType.toUpperCase().indexOf("TOKEN")?this.verifyIdToken(oauthData,current.name)?oauthData:Promise.reject("OAuth 2.0 Nonce parameter mismatch."):this.exchangeForToken(oauthData,userData,current)))}verifyIdToken(oauthData,providerName){let idToken=oauthData&&oauthData[this.config.responseIdTokenProp];if(!idToken)return!0;let idTokenObject=this.auth.decomposeToken(idToken);if(!idTokenObject)return!0;let nonceFromToken=idTokenObject.nonce;return!nonceFromToken||nonceFromToken===this.storage.get(providerName+"_nonce")}exchangeForToken(oauthData,userData,current){let data=extend({},userData,{code:oauthData.code,clientId:current.clientId,redirectUri:current.redirectUri});oauthData.state&&(data.state=oauthData.state),forEach(current.responseParams,(param=>data[param]=oauthData[param]));let exchangeForTokenUrl=this.config.baseUrl?joinUrl(this.config.baseUrl,current.url):current.url,credentials=this.config.withCredentials?"include":"same-origin";return this.http.fetch(exchangeForTokenUrl,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:json(data),credentials:credentials}).then(status)}buildQueryString(current){let keyValuePairs=[];return forEach(["defaultUrlParams","requiredUrlParams","optionalUrlParams"],(params=>{forEach(current[params],(paramName=>{let camelizedName=paramName.replace(/([\:\-\_]+(.))/g,(function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}));let paramValue=isFunction(current[paramName])?current[paramName]():current[camelizedName];if("state"===paramName){let stateName=current.name+"_state";paramValue=encodeURIComponent(this.storage.get(stateName))}if("nonce"===paramName){let nonceName=current.name+"_nonce";paramValue=encodeURIComponent(this.storage.get(nonceName))}"scope"===paramName&&Array.isArray(paramValue)&&(paramValue=paramValue.join(current.scopeDelimiter),current.scopePrefix&&(paramValue=[current.scopePrefix,paramValue].join(current.scopeDelimiter))),keyValuePairs.push([paramName,paramValue])}))})),keyValuePairs.map((pair=>pair.join("="))).join("&")}};OAuth2=__decorate([__param(3,IHttpClient),__param(4,IAuthConfigOptions),__metadata("design:paramtypes",[Storage,Popup,Authentication,Object,Object])],OAuth2);const IAuthService=DI.createInterface("IAuthService",(x=>x.singleton(AuthService)));let AuthService=class{http;auth;oAuth1;oAuth2;config;eventAggregator;tokenInterceptor;constructor(http,auth,oAuth1,oAuth2,config,eventAggregator){this.http=http,this.auth=auth,this.oAuth1=oAuth1,this.oAuth2=oAuth2,this.config=config,this.eventAggregator=eventAggregator,this.tokenInterceptor=auth.tokenInterceptor}getMe(){let profileUrl=this.auth.getProfileUrl();return this.http.fetch(profileUrl).then(status)}isAuthenticated(){return this.auth.isAuthenticated()}getTokenPayload(){return this.auth.getPayload()}setToken(token){this.auth.setToken(Object.defineProperty({},this.config.tokenName,{value:token}))}signup(displayName,email,password){let content,signupUrl=this.auth.getSignupUrl();return content="object"==typeof arguments[0]?arguments[0]:{displayName:displayName,email:email,password:password},this.http.fetch(signupUrl,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:json(content)}).then(status).then((response=>(this.config.loginOnSignup?this.auth.setToken(response):this.config.signupRedirect&&(window.location.href=this.config.signupRedirect),this.eventAggregator.publish("auth:signup",response),response)))}login(req){let content,loginUrl=this.auth.getLoginUrl();return content=null!=req.credentials?req.credentials:{email:req.email,password:req.password},this.http.fetch(loginUrl,{method:"post",headers:"string"==typeof content?{"Content-Type":"application/x-www-form-urlencoded"}:{},body:"string"==typeof content?content:json(content)}).then(status).then((response=>(this.auth.setToken(response),this.eventAggregator.publish("auth:login",response),response)))}logout(redirectUri){return this.auth.logout(redirectUri).then((()=>{this.eventAggregator.publish("auth:logout")}))}authenticate(name,redirect,userData){let provider=this.oAuth2;return"1.0"===this.config.providers[name].type&&(provider=this.oAuth1),provider.open(this.config.providers[name],userData||{}).then((response=>(this.auth.setToken(response,redirect),this.eventAggregator.publish("auth:authenticate",response),response)))}unlink(provider){let unlinkUrl=this.config.baseUrl?joinUrl(this.config.baseUrl,this.config.unlinkUrl):this.config.unlinkUrl;return"get"===this.config.unlinkMethod?this.http.fetch(unlinkUrl+provider).then(status).then((response=>(this.eventAggregator.publish("auth:unlink",response),response))):"post"===this.config.unlinkMethod?this.http.fetch(unlinkUrl,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:json(provider)}).then(status).then((response=>(this.eventAggregator.publish("auth:unlink",response),response))):void 0}};AuthService=__decorate([__param(4,IAuthConfigOptions),__param(5,IEventAggregator),__metadata("design:paramtypes",[HttpClient,Authentication,OAuth1,OAuth2,Object,Object])],AuthService);let AuthorizeHook=class{auth;router;constructor(auth,router){this.auth=auth,this.router=router,this.auth=auth}canLoad(vm,params,next,current){let isLoggedIn=this.auth.isAuthenticated(),loginRoute=this.auth.getLoginRoute();return!(next?.data?.auth&&!isLoggedIn)||(this.auth.setInitialUrl(window.location.href),this.router.load(loginRoute))}};AuthorizeHook=__decorate([lifecycleHooks(),__param(1,IRouter),__metadata("design:paramtypes",[Authentication,Object])],AuthorizeHook);let AuthFilterValueConverter=class{toView(routes,isAuthenticated){return routes.filter((r=>void 0===!r?.data?.auth||r?.data?.auth===isAuthenticated))}};AuthFilterValueConverter=__decorate([valueConverter("auth-filter")],AuthFilterValueConverter);const DefaultComponents=[AuthFilterValueConverter];const AureliaAuthConfiguration=function createConfiguration(options){return{register(container){const mergedOptions={...defaultAuthConfigOptions,...options};return container.register(Registration.instance(IAuthConfigOptions,mergedOptions),...DefaultComponents)},configure:options=>createConfiguration(options)}}({});export{AureliaAuthConfiguration,AuthFilterValueConverter,AuthService,Authentication,AuthorizeHook,DefaultComponents,FetchConfig,IAuthConfigOptions,IAuthService,OAuth1,OAuth2,Popup};
